<html>
    <head>
        <title>J!ometry: Daily Jeopardy Visualizations</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto">
        <link rel="stylesheet" href="css/site.css"></link>
        <link rel="stylesheet" href="css/season.css"></link>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>
        <script src="/js/d3/d3.v7.min.js"></script>
        <script src="/js/util/util.v3.js"></script>
        <script src="/js/graphs/period_box_plot.v2.js"></script>
        <script src="/js/graphs/full_game_scatter.v3.js"></script>
        <script src="/js/graphs/by_round_scatter.v1.js"></script>
        <script src="/js/util/shared_graph_production.v4.js"></script>
    </head>
    <body>
        <h1><a href="index.html">J!ometry</a></h1>
        <div>
            <a href="/index.html">Home</a>&nbsp;<a href="/glossary.html">Glossary</a>
        </div>
        <div class="section">
            <h1><span id="toc-period-id"></span> Qualification Period Summary</h1>
            <div class="graph-description">
                "Average" is the average of all contestant performances, not just those shown individually. Each game performace
                is a separate data point, so champions are included separately in the average for each of their games.
            </div>
            <div id="season-contestant-summary" class="season-contestant-summary">
                <table>
                    <thead>
                        <tr>
                            <th colspan="6" class="empty"></th>
                            <th colspan="11">Game Averages</th>
                        </tr>
                        <tr>
                            <th>Contestant</th>
                            <th>Wins</th>
                            <th>Leads</th>
                            <th>Crushes</th>
                            <th>Locks</th>
                            <th>TotalWin$</th>
                            <th>BuzC</th>
                            <th>BuzI</th>
                            <th>BuzC$</th>
                            <th>BuzI$</th>
                            <th>Buz$</th>
                            <th>BuzC$/</th>
                            <th>BuzI$/</th>
                            <th>DDF</th>
                            <th>DD+</th>
                            <th>DD$</th>
                            <th>FJ$</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div id="season-contestant-summary-j" class="season-contestant-summary">
                <table>
                    <thead>
                        <tr>
                            <th colspan="1" class="empty"></th>
                            <th colspan="10">Jeopardy! Round Avg</th>
                        </tr>
                        <tr>
                            <th>Contestant</th>
                            <th>BuzC</th>
                            <th>BuzI</th>
                            <th>BuzC$</th>
                            <th>BuzI$</th>
                            <th>Buz$</th>
                            <th>BuzC$/</th>
                            <th>BuzI$/</th>
                            <th>DDF</th>
                            <th>DD+</th>
                            <th>DD$</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div id="season-contestant-summary-dj" class="season-contestant-summary">
                <table>
                    <thead>
                        <tr>
                            <th colspan="1" class="empty"></th>
                            <th colspan="10">Double Jeopardy! Round Avg</th>
                        </tr>
                        <tr>
                            <th>Contestant</th>
                            <th>BuzC</th>
                            <th>BuzI</th>
                            <th>BuzC$</th>
                            <th>BuzI$</th>
                            <th>Buz$</th>
                            <th>BuzC$/</th>
                            <th>BuzI$/</th>
                            <th>DDF</th>
                            <th>DD+</th>
                            <th>DD$</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
            </div>
            <div class="graph-description">
                Att = Attempts, ExpBuz = Expected buzzes, BuzC = Correct on buzz,
                Speed = Est. buzzes created through speed, Solo = Estimated buzzes uncontested,
                Buz$ = Score on buzz, DDF = Daily Doubles found, DD+ = Daily Doubles found above expectation
            </div>
        </div>
        <div class="section">
            <h1>Buzz Distribution</h1>
            <div class="graph-description">
                Average buzzes, by contestant. Correct responses are at the bottom, incorrect responses are lighter and
                on top.
            </div>
            <div id="bar-buzzes" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div class="graph-description">
                Average score on buzzes, by contestant. Score is shown full color. Score lost on incorrect buzz responses is shown lighter on top.
                Score on correct buzz responses is the sum of the two.
            </div>
            <div id="bar-buz$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-buzc-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
            <div id="line-buzi-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Buzzes</h1>
            <div class="graph-description">
                Buzzes, by contestant, in each game.
            </div>
            <div id="box-buz" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-buz-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Attempts</h1>
            <div class="graph-description">
                Attempts, by contestant, in each game.
            </div>
            <div id="box-att" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-att-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Buz%</h1>
            <div class="graph-description">
                Buzzes/Attempts, by contestant, in each game.
            </div>
            <div id="box-buz%" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-buz%-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Buz$</h1>
            <div class="graph-description">
                Money earned/lost on buzzes, by contestant, in each game.
            </div>
            <div id="box-buz$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-buz$-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Buz$/Buz</h1>
            <div class="graph-description">
                Money earned/lost on buzzes on the average buzz, by contestant, in each game.
            </div>
            <div id="box-buz$-per-buz" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-buz$-per-buz-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Speed</h1>
            <div class="graph-description">
                Estimated buzzes earned by speed, by contestant, in each game.
            </div>
            <div id="box-speed" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-speed-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Solo</h1>
            <div class="graph-description">
                Estimated buzzes where only contestant attempting, by contestant, in each game.
            </div>
            <div id="box-solo" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-solo-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Speed plus Solo</h1>
            <div class="graph-description">
                Speed plus Solo, by contestant, in each game. Each value varies widely based on the competition, but the sum is meaningful.
            </div>
            <div id="box-speed-plus-solo" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-speed-plus-solo-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>DD+</h1>
            <div class="graph-description">
                Daily Doubles found above expected number, by contestant, in each game.
            </div>
            <div id="box-dd+" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-dd+-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>DD$</h1>
            <div class="graph-description">
                Money earned/lost on Daily Doubles, by contestant, in each game.
            </div>
            <div id="box-dd$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
            <div id="line-dd$-j-dj" style="width:600px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>DJFinal$</h1>
            <div class="graph-description">
                Score after Double Jeopardy, by contestant, in each game.
            </div>
            <div id="box-djfinal$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>FJ$</h1>
            <div class="graph-description">
                Money earned/lost on Final Jeopardy, by contestant, in each game.
            </div>
            <div id="box-fj$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>FJFinal$</h1>
            <div class="graph-description">
                Final score after Final Jeopardy, by contestant, in each game.
            </div>
            <div id="box-fjfinal$" style="width:1000px;height:500px;margin-bottom:1em;"></div>
        </div>
        <div class="section">
            <h1>Buz$/Buz vs Buz plot</h1>
            <div class="graph-description">
                Buz$/Buz vs Buz, per game. 4+ game champions are marked larger.
            </div>
            <div id="scatter-buz$-buz-vs-buz" style="width:1000px;height:500px;"></div>
        </div>
        <div class="section">
            <h1>Avg Buz$/Buz vs Buz plot</h1>
            <div class="graph-description">
                Average Buz$/Buz vs Buz, per contestant.
            </div>
            <div id="scatter-avg-buz$-buz-vs-buz" style="width:1000px;height:500px;"></div>
        </div>
        <div id="footer">
            <p>This site is not affiliated with Jeopardy!. Data is taken from their published <a href="https://www.jeopardy.com/jbuzz/news-events/jeopardy-daily-box-scores">box scores.</a></p>
        </div>
        <script type="text/javascript">
            var tocPeriodId = new URLSearchParams(window.location.search).get('toc_period');
            var tocPeriodAverageLabel = tocPeriodId + " Average";
            d3.select("#toc-period-id")
                .data([tocPeriodId])
                .text(d => d);
            d3.csv(csvUrlForTocPeriod(tocPeriodId)).then(function(data) {
                //Data transformations
                data.forEach(function(d) {
                    d['Date'] = csvDateParse(d['Date']);
                    d['BuzC'] = +d['JBuzC'] + +d['DJBuzC'];
                    d['BuzI'] = +d['JBuzInc'] + +d['DJBuzInc'];
                    d['JBuz%'] = 100.0 * d['JBuz'] / d['JAtt'];
                    d['DJBuz%'] = 100.0 * d['DJBuz'] / d['DJAtt'];
                    d['Buz%'] = 100.0 * d['Buz'] / d['Att'];
                    d['FJ$'] = d['FJCor'] === "" ? 0 : (2 * +d['FJCor'] - 1) * +d['FJWager'];
                });

                var highlightContestantCounts = d3.rollup(data, v => d3.sum(d3.map(v, cd => (+cd['Wins']))), d => d['Jometry Contestant Id']);
                var contestantWinnings = d3.rollup(data, v => d3.sum(d3.map(v, cd => (+cd['Wins'] * +cd['FJFinal$']))), d => d['Jometry Contestant Id']);
                var gameThreshold = 4;
                highlightContestantIds = d3.filter(highlightContestantCounts.keys(), k => highlightContestantCounts.get(k) >= gameThreshold);
                while (highlightContestantIds.length < 5) {
                    gameThreshold--;
                    highlightContestantIds = d3.filter(highlightContestantCounts.keys(), k => highlightContestantCounts.get(k) >= gameThreshold);
                }

                var latestDate = d3.max(d3.map(data, d => d['Date']));
                var currentChampionToHighlight = d3.map(d3.filter(data, d => d['Date'] >= latestDate && +d['Wins'] > 0), d => d['Jometry Contestant Id']);
                if ((new Date().getTime() - latestDate.getTime()) / (1000 * 3600 * 24) <= 5) {
                    highlightContestantIds = highlightContestantIds.concat(Array.from(d3.difference(currentChampionToHighlight, highlightContestantIds)));
                }

                highlightContestantIds.sort(function(a,b) {
                    var winsDiff = highlightContestantCounts.get(b) - highlightContestantCounts.get(a);
                    if (winsDiff !== 0) {
                        return winsDiff;
                    }
                    return contestantWinnings.get(b) - contestantWinnings.get(a);
                });
                data.forEach(function(d) {
                    d['highlightContestant'] = highlightContestantIds.includes(d['Jometry Contestant Id']);
                });

                //Graphics functions
                var color = d3.scaleOrdinal()
                    .domain(highlightContestantIds)
                    .range(d3.schemeCategory10.concat(d3.schemeDark2));
                var colorFunction = function(d) {
                    if (d['highlightContestant']) {
                        return color(d['Jometry Contestant Id']);
                    } else {
                        return "black";
                    }
                };
                var opacityFunction = function(d) {
                    if (d['highlightContestant']) {
                        return 1;
                    } else {
                        return 0.1;
                    }
                };
                var labelFunction = function(d) {
                    return "";
                };

                var summarizeContestantData = function(contestantId, contestantData) {
                    return {
                        'Contestant': contestantId >= 0 ? d3.map(contestantData, cd => cd['Contestant'])[0] : tocPeriodAverageLabel,
                        'Jometry Contestant Id': contestantId,
                        'Wins': d3.sum(d3.map(contestantData, cd => (+cd['Wins']))),
                        'Leads': d3.sum(d3.map(contestantData, cd => (+cd['Leads']))),
                        'Crushes': d3.sum(d3.map(contestantData, cd => (+cd['Crushes']))),
                        'Locks': d3.sum(d3.map(contestantData, cd => (+cd['Locks']))),
                        'TotalWin$': d3.sum(d3.map(contestantData, cd => (+cd['Wins'] * +cd['FJFinal$']))),
                        'Buz': d3.mean(d3.map(contestantData, cd => (+cd['Buz']))),
                        'BuzC': d3.mean(d3.map(contestantData, cd => (+cd['JBuzC'] + +cd['DJBuzC']))),
                        'BuzI': d3.mean(d3.map(contestantData, cd => (+cd['JBuzInc'] + +cd['DJBuzInc']))),
                        'Buz$': d3.mean(d3.map(contestantData, cd => (+cd['Buz$']))),
                        'BuzC$': d3.mean(d3.map(contestantData, cd => (+cd['JBuzC$'] + +cd['DJBuzC$']))),
                        'BuzI$': d3.mean(d3.map(contestantData, cd => (+cd['JBuzI$'] + +cd['DJBuzI$']))),
                        'BuzC$/BuzC': 1.0 * d3.mean(d3.map(contestantData, cd => (+cd['JBuzC$'] + +cd['DJBuzC$']))) / d3.mean(d3.map(contestantData, cd => (+cd['JBuzC'] + +cd['DJBuzC']))),
                        'BuzI$/BuzI': 1.0 * d3.mean(d3.map(contestantData, cd => (+cd['JBuzI$'] + +cd['DJBuzI$']))) / d3.mean(d3.map(contestantData, cd => (+cd['JBuzInc'] + +cd['DJBuzInc']))),
                        'DDF': d3.mean(d3.map(contestantData, cd => (+cd['JDDF'] + +cd['DJDDF']))),
                        'DD+': d3.mean(d3.map(contestantData, cd => (+cd['DD+']))),
                        'DD$': d3.mean(d3.map(contestantData, cd => (+cd['JDD'] + +cd['DJDD1'] + +cd['DJDD2']))),
                        'JBuz': d3.mean(d3.map(contestantData, cd => (+cd['JBuz']))),
                        'JBuzC': d3.mean(d3.map(contestantData, cd => (+cd['JBuzC']))),
                        'JBuzI': d3.mean(d3.map(contestantData, cd => (+cd['JBuzInc']))),
                        'JBuz$': d3.mean(d3.map(contestantData, cd => (+cd['JBuz$']))),
                        'JBuzC$': d3.mean(d3.map(contestantData, cd => (+cd['JBuzC$']))),
                        'JBuzI$': d3.mean(d3.map(contestantData, cd => (+cd['JBuzI$']))),
                        'JBuzC$/JBuzC': 1.0 * d3.mean(d3.map(contestantData, cd => (+cd['JBuzC$']))) / d3.mean(d3.map(contestantData, cd => (+cd['JBuzC']))),
                        'JBuzI$/JBuzI': 1.0 * d3.mean(d3.map(contestantData, cd => (+cd['JBuzI$']))) / d3.mean(d3.map(contestantData, cd => (+cd['JBuzInc']))),
                        'JDDF': d3.mean(d3.map(contestantData, cd => (+cd['JDDF']))),
                        'JDD+': d3.mean(d3.map(contestantData, cd => (+cd['JDD+']))),
                        'JDD$': d3.mean(d3.map(contestantData, cd => (+cd['JDD']))),
                        'DJBuz': d3.mean(d3.map(contestantData, cd => (+cd['DJBuz']))),
                        'DJBuzC': d3.mean(d3.map(contestantData, cd => (+cd['DJBuzC']))),
                        'DJBuzI': d3.mean(d3.map(contestantData, cd => (+cd['DJBuzInc']))),
                        'DJBuz$': d3.mean(d3.map(contestantData, cd => (+cd['DJBuz$']))),
                        'DJBuzC$': d3.mean(d3.map(contestantData, cd => (+cd['DJBuzC$']))),
                        'DJBuzI$': d3.mean(d3.map(contestantData, cd => (+cd['DJBuzI$']))),
                        'DJBuzC$/DJBuzC': 1.0 * d3.mean(d3.map(contestantData, cd => (+cd['DJBuzC$']))) / d3.mean(d3.map(contestantData, cd => (+cd['DJBuzC']))),
                        'DJBuzI$/DJBuzI': 1.0 * d3.mean(d3.map(contestantData, cd => (+cd['DJBuzI$']))) / d3.mean(d3.map(contestantData, cd => (+cd['DJBuzInc']))),
                        'DJDDF': d3.mean(d3.map(contestantData, cd => (+cd['DJDDF']))),
                        'DJDD+': d3.mean(d3.map(contestantData, cd => (+cd['DJDD+']))),
                        'DJDD$': d3.mean(d3.map(contestantData, cd => (+cd['DJDD1'] + +cd['DJDD2']))),
                        'FJ$': d3.mean(d3.map(contestantData, cd => (+cd['FJ$']))),
                        'Buz%': 100.0 * d3.sum(d3.map(contestantData, cd => (+cd['Buz']))) / d3.sum(d3.map(contestantData, cd => (+cd['Att'])))
                    };
                }


                //Summary table
                var summaryData = Array.from(
                    d3.group(d3.filter(data, d => d['highlightContestant']), d => d['Jometry Contestant Id']),
                    ([contestantId, contestantData]) => summarizeContestantData(contestantId, contestantData));
                summaryData.sort(function(a,b) { return highlightContestantIds.indexOf(a['Jometry Contestant Id']) - highlightContestantIds.indexOf(b['Jometry Contestant Id']); });

                var averageSummary = summarizeContestantData(-1, data);
                averageSummary['Wins'] = "";
                averageSummary['Leads'] = "";
                averageSummary['Crushes'] = "";
                averageSummary['Locks'] = "";
                averageSummary['TotalWin$'] = "";
                var summaryDataWithAverage = summaryData.concat(averageSummary);
                var summaryColorFunction = function(d) {
                    if (d['Contestant'] === tocPeriodAverageLabel) {
                        return "black";
                    } else {
                        return color(d['Contestant']);
                    }
                }

                var summaryTr = d3.select("#season-contestant-summary table tbody")
                    .selectAll("tr")
                    .data(summaryDataWithAverage)
                    .enter()
                    .append("tr");
                summaryTr.selectAll("td")
                    .data(function(d,i) {
                        return [
                            [d['Jometry Contestant Id'], d['Contestant']],
                            d['Wins'],
                            d['Leads'],
                            d['Crushes'],
                            d['Locks'],
                            d['TotalWin$'],
                            d['BuzC'].toFixed(1),
                            d['BuzI'].toFixed(1),
                            d['BuzC$'].toFixed(0),
                            d['BuzI$'].toFixed(0),
                            d['Buz$'].toFixed(0),
                            d['BuzC$/BuzC'].toFixed(0),
                            d['BuzI$/BuzI'].toFixed(0),
                            d['DDF'].toFixed(1),
                            (d['DD+'] >= 0 ? "+" : "") + d['DD+'].toFixed(1),
                            d['DD$'].toFixed(0),
                            d['FJ$'].toFixed(0),
                        ];
                    })
                    .enter()
                    .append("td")
                    .html(function(d,i) {
                        if (i>0) return d;
                        if (d[1] === tocPeriodAverageLabel) return '<span style="color:black">&#9632;</span>&nbsp;' + d[1];
                        return '<span style="color: ' + color(d[0]) + '">&#9632;</span>&nbsp;<a href="contestant.html?toc_period_id=' + tocPeriodId + '&contestant=' + d[0] + '">' + d[1] + "</a>";
                    });

                var summaryTr = d3.select("#season-contestant-summary-j table tbody")
                    .selectAll("tr")
                    .data(summaryDataWithAverage)
                    .enter()
                    .append("tr");
                summaryTr.selectAll("td")
                    .data(function(d,i) {
                        return [
                            [d['Jometry Contestant Id'], d['Contestant']],
                            d['JBuzC'].toFixed(1),
                            d['JBuzI'].toFixed(1),
                            d['JBuzC$'].toFixed(0),
                            d['JBuzI$'].toFixed(0),
                            d['JBuz$'].toFixed(0),
                            d['JBuzC$/JBuzC'].toFixed(0),
                            d['JBuzI$/JBuzI'].toFixed(0),
                            d['JDDF'].toFixed(1),
                            (d['JDD+'] >= 0 ? "+" : "") + d['JDD+'].toFixed(1),
                            d['JDD$'].toFixed(0)
                        ];
                    })
                    .enter()
                    .append("td")
                    .html(function(d,i) {
                        if (i>0) return d;
                        if (d[1] === tocPeriodAverageLabel) return '<span style="color:black">&#9632;</span>&nbsp;' + d[1];
                        return '<span style="color: ' + color(d[0]) + '">&#9632;</span>&nbsp;<a href="contestant.html?toc_period=' + tocPeriodId + '&contestant=' + d[0] + '">' + d[1] + "</a>";
                    });

                var summaryTr = d3.select("#season-contestant-summary-dj table tbody")
                    .selectAll("tr")
                    .data(summaryDataWithAverage)
                    .enter()
                    .append("tr");
                summaryTr.selectAll("td")
                    .data(function(d,i) {
                        return [
                            [d['Jometry Contestant Id'], d['Contestant']],
                            d['DJBuzC'].toFixed(1),
                            d['DJBuzI'].toFixed(1),
                            d['DJBuzC$'].toFixed(0),
                            d['DJBuzI$'].toFixed(0),
                            d['DJBuz$'].toFixed(0),
                            d['DJBuzC$/DJBuzC'].toFixed(0),
                            d['DJBuzI$/DJBuzI'].toFixed(0),
                            d['DJDDF'].toFixed(1),
                            (d['DJDD+'] >= 0 ? "+" : "") + d['DJDD+'].toFixed(1),
                            d['DJDD$'].toFixed(0)
                        ];
                    })
                    .enter()
                    .append("td")
                    .html(function(d,i) {
                        if (i>0) return d;
                        if (d[1] === tocPeriodAverageLabel) return '<span style="color:black">&#9632;</span>&nbsp;' + d[1];
                        return '<span style="color: ' + color(d[0]) + '">&#9632;</span>&nbsp;<a href="contestant.html?toc_period=' + tocPeriodId + '&contestant=' + d[0] + '">' + d[1] + "</a>";
                    });

                //Buzzes
                var attemptsTraceBuzC = {
                    x: d3.map(highlightContestantIds, c => d3.filter(data, cd => cd['Jometry Contestant Id'] === c)[0]['Contestant']),
                    y: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['BuzC']))),
                    text: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['BuzC'])).toFixed(1)),
                    type: 'bar',
                    marker: {
                        color: d3.map(highlightContestantIds, color),
                        line: {
                            color: 'black',
                            width: 1
                        }
                    }
                };
                var attemptsTraceBuzI = {
                    x: d3.map(highlightContestantIds, c => d3.filter(data, cd => cd['Jometry Contestant Id'] === c)[0]['Contestant']),
                    y: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['BuzI']))),
                    text: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['BuzI'])).toFixed(1)),
                    type: 'bar',
                    marker: {
                        color: d3.map(highlightContestantIds, color),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 0.5
                    }
                };
                var attemptsData = [attemptsTraceBuzC, attemptsTraceBuzI];
                var attemptsLayout = {
                    barmode: 'stack',
                    showlegend: false,
                    yaxis: {
                        title: {
                            text: "Buzzes",
                            standoff: 20
                        }
                    }
                };
                Plotly.newPlot('bar-buzzes', attemptsData, attemptsLayout);

                var traceBuzScore = {
                    x: d3.map(highlightContestantIds, c => d3.filter(data, cd => cd['Jometry Contestant Id'] === c)[0]['Contestant']),
                    y: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['Buz$']))),
                    text: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['Buz$'])).toFixed(0)),
                    type: 'bar',
                    marker: {
                        color: d3.map(highlightContestantIds, color),
                        line: {
                            color: 'black',
                            width: 1
                        }
                    }
                };
                var traceBuzIScore = {
                    x: d3.map(highlightContestantIds, c => d3.filter(data, cd => cd['Jometry Contestant Id'] === c)[0]['Contestant']),
                    y: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['JBuzI$'] + +cd1['DJBuzI$']))),
                    text: d3.map(highlightContestantIds, c => d3.mean(d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === c), cd1 => +cd1['JBuzI$'] + +cd1['DJBuzI$'])).toFixed(0)),
                    type: 'bar',
                    marker: {
                        color: d3.map(highlightContestantIds, color),
                        line: {
                            color: 'black',
                            width: 1
                        },
                        opacity: 0.5
                    }
                };
                var buzScoreData = [traceBuzScore, traceBuzIScore];
                var buzScoreLayout = {
                    barmode: 'stack',
                    showlegend: false,
                    yaxis: {
                        title: {
                            text: "Buz$",
                            standoff: 20
                        }
                    }
                };
                Plotly.newPlot('bar-buz$', buzScoreData, buzScoreLayout);


                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JBuzC'],
                    cd1 => +cd1['DJBuzC'],
                    'line-buzc-j-dj',
                    'BuzC difference',
                    cd => true,
                    'BuzC'
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JBuzInc'],
                    cd1 => +cd1['DJBuzInc'],
                    'line-buzi-j-dj',
                    'BuzI difference',
                    cd => true,
                    'BuzI'
                );


                //Histogram set
                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Buz'],
                    'box-buz',
                    'Buz',
                    cd1 => true
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JBuz'],
                    cd1 => +cd1['DJBuz'],
                    'line-buz-j-dj',
                    'Buz difference',
                    cd => true,
                    'Buz'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Att'],
                    'box-att',
                    'Att',
                    cd1 => cd1['Att'] !== ""
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JAtt'],
                    cd1 => +cd1['DJAtt'],
                    'line-att-j-dj',
                    'Att difference',
                    cd1 => cd1['Att'] !== "",
                    'Att'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Buz%'],
                    'box-buz%',
                    'Buz%',
                    cd1 => cd1['Att'] !== ""
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JBuz%'],
                    cd1 => +cd1['DJBuz%'],
                    'line-buz%-j-dj',
                    'Buz% difference',
                    cd1 => cd1['Att'] !== "",
                    'Buz%'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Buz$'],
                    'box-buz$',
                    'Buz$',
                    cd1 => true
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JBuz$'],
                    cd1 => +cd1['DJBuz$'] / 2.0,
                    'line-buz$-j-dj',
                    'Buz$ difference',
                    cd => true,
                    'Buz$ (J dollars)'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => 1.0 * +cd1['Buz$'] / +cd1['Buz'],
                    'box-buz$-per-buz',
                    'Buz$/Buz',
                    cd1 => true
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JBuz$'] / +cd1['JBuz'],
                    cd1 => +cd1['DJBuz$'] / 2.0 / +cd1['DJBuz'],
                    'line-buz$-per-buz-j-dj',
                    'Buz$/Buz difference',
                    cd => true,
                    'Buz$ (J dollars)'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Speed'],
                    'box-speed',
                    'Speed',
                    cd1 => cd1['Speed'] !== ""
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JSpeed'],
                    cd1 => +cd1['DJSpeed'],
                    'line-speed-j-dj',
                    'Speed difference',
                    cd1 => cd1['Speed'] !== "",
                    'Speed'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Solo'],
                    'box-solo',
                    'Solo',
                    cd1 => cd1['Solo'] !== ""
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JSolo'],
                    cd1 => +cd1['DJSolo'],
                    'line-solo-j-dj',
                    'Solo difference',
                    cd1 => cd1['Solo'] !== "",
                    'Solo'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['Speed'] + +cd1['Solo'],
                    'box-speed-plus-solo',
                    'Speed + Solo',
                    cd1 => cd1['Solo'] !== ""
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JSpeed'] + +cd1['JSolo'],
                    cd1 => +cd1['DJSpeed'] + +cd1['DJSolo'],
                    'line-speed-plus-solo-j-dj',
                    'Speed+Solo difference',
                    cd1 => cd1['Solo'] !== "",
                    'Speed + Solo'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['DD+'],
                    'box-dd+',
                    'DD+',
                    cd1 => cd1['DD+'] !== ""
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JDD+'],
                    cd1 => +cd1['DJDD+'],
                    'line-dd+-j-dj',
                    'DD+ difference',
                    cd => true,
                    'DD+'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JDD'] + +cd1['DJDD1'] + +cd1['DJDD2'],
                    'box-dd$',
                    'DD$',
                    cd1 => true
                );
                renderHighlightContestantRoundLinePlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['JDD'],
                    cd1 => (+cd1['DJDD1'] + +cd1['DJDD2']) / 2.0,
                    'line-dd$-j-dj',
                    'DD$ difference',
                    cd => true,
                    'DD$ (J dollars)'
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['DJFinal$'],
                    'box-djfinal$',
                    'DJFinal$',
                    cd1 => cd1['DJFinal$'] !== ""
                );

                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['FJ$'],
                    'box-fj$',
                    'FJ$',
                    cd1 => cd1['FJ$'] !== ""
                );
                
                renderHighlightContestantBoxPlot(
                    data,
                    highlightContestantIds,
                    cd1 => +cd1['FJFinal$'],
                    'box-fjfinal$',
                    'FJFinal$',
                    cd1 => cd1['FJFinal$'] !== ""
                );
                

                plotData = [];
                for ( var i = 0; i < highlightContestantIds.length; i ++ ) {
                    var cid = highlightContestantIds[i];
                    var trace = {
                        x: d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === cid), cd1 => +cd1['Buz']),
                        y: d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === cid), cd1 => +cd1['Buz$'] / +cd1['Buz']),
                        mode: 'markers',
                        type: 'scatter',
                        name: getContestantNameFromData(data, cid),
                        text: d3.map(d3.filter(data, cd => cd['Jometry Contestant Id'] === cid), cd1 => cd1['Contestant'] + ", " + dateFormat(cd1['Date'])),
                        marker: { size: 5 }
                    };
                    plotData.push(trace);
                }
                var trace = {
                    x: d3.map(d3.filter(data, cd => !highlightContestantIds.includes(cd['Jometry Contestant Id'])), cd1 => +cd1['Buz']),
                    y: d3.map(d3.filter(data, cd => !highlightContestantIds.includes(cd['Jometry Contestant Id'])), cd1 => +cd1['Buz$'] / +cd1['Buz']),
                    mode: 'markers',
                    type: 'scatter',
                    name: "Others",
                    text: d3.map(d3.filter(data, cd => !highlightContestantIds.includes(cd['Jometry Contestant Id'])), cd1 => cd1['Contestant'] + ", " + dateFormat(cd1['Date'])),
                    marker: { size: 2 }
                };
                plotData.push(trace);

                var layout = {
                    xaxis: {
                        range: [ 0, 50 ]
                    },
                    yaxis: {
                        range: [-500, 1200]
                    },
                    legend: {
                        y: 0.5,
                        yref: 'paper',
                        font: {
                        family: 'Arial, sans-serif',
                        size: 20,
                        color: 'grey',
                        }
                    },
                    xaxis: {
                        title: 'Buz'
                    },
                    yaxis: {
                        title: 'Buz$/Buz'
                    },
                    title:'Buz$/Buz vs Buz'
                };

                Plotly.newPlot('scatter-buz$-buz-vs-buz', plotData, layout);

                plotData = [];
                var groupedData = d3.group(data, cd => cd['Jometry Contestant Id']);
                groupedData.forEach((value, key) => {
                    if (highlightContestantIds.includes(key)) {
                        var trace = {
                            x: [d3.mean(d3.map(value, cd1 => +cd1['Buz']))],
                            y: [d3.mean(d3.map(value, cd1 => +cd1['Buz$'] / +cd1['Buz']))],
                            mode: 'markers+text',
                            type: 'scatter',
                            text: getContestantNameFromData(data, key),
                            textposition: 'top center',
                            marker: { size: 2 * Math.sqrt(value.length) },
                            showlegend: false
                        };
                        plotData.push(trace);
                    }
                });
                

                var layout = {
                    xaxis: {
                        title: 'Buz'
                    },
                    yaxis: {
                        title: 'Buz$/Buz'
                    },
                    title:'Average Buz$/Buz vs Buz'
                };

                Plotly.newPlot('scatter-avg-buz$-buz-vs-buz', plotData, layout);

            });
        </script>
    </body>
</html>